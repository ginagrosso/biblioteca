{% extends 'gestion_libros/base.html' %}

{% block title %}Inicio{% endblock %}

{% block content %}

{% if not user.is_authenticated %}
<!-- Mensaje de bienvenida para usuarios no autenticados -->
<div class="container text-center py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <i class="bi bi-shield-lock" style="font-size: 4rem; color: var(--primary); opacity: 0.7;"></i>
            <h2 class="mt-4 mb-3" style="font-family: 'Crimson Text', serif; color: var(--text-dark);">
                Acceso Restringido
            </h2>
            <p class="text-muted mb-4" style="font-size: 1.1rem;">
                Esta plataforma es para uso exclusivo del personal de la biblioteca.<br>
                Iniciá sesión para acceder a las herramientas de gestión.
            </p>
            <a href="{% url 'login' %}" class="btn btn-primary btn-lg">
                <i class="bi bi-box-arrow-in-right me-2"></i> Iniciar Sesión
            </a>
        </div>
    </div>
</div>
{% else %}
<!-- Bienvenida personalizada -->
<div class="container mb-4">
    <div class="alert" style="background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-white) 100%); border: 1px solid var(--border); border-left: 4px solid var(--primary);">
        <h5 class="mb-2" style="color: var(--text-dark);">
            <i class="bi bi-person-circle me-2"></i>Bienvenida, <strong>{{ user.username }}</strong>
        </h5>
        <p class="mb-0 text-muted" style="font-size: 0.95rem;">
            <i class="bi bi-calendar-check me-1"></i>Hoy: <strong>{% now "l, j \d\e F \d\e Y" %}</strong> 
            <span class="ms-3"><i class="bi bi-clock me-1"></i>{% now "H:i" %} hs</span>
        </p>
    </div>
</div>

<!-- Panel de estadísticas -->
<div class="container mb-4">
    <div class="row g-3 mb-4">
        <div class="col-6 col-md-3">
            <div class="card text-center h-100" style="border: 1px solid var(--border); background: var(--bg-white); transition: all 0.2s;">
                <div class="card-body p-3">
                    <i class="bi bi-book" style="font-size: 2.5rem; color: var(--primary);"></i>
                    <h2 class="mb-0 mt-2" style="font-weight: 600;">{{ total_libros }}</h2>
                    <small class="text-muted">Títulos Activos</small>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card text-center h-100" style="border: 1px solid var(--border); background: var(--bg-white); transition: all 0.2s;">
                <div class="card-body p-3">
                    <i class="bi bi-people" style="font-size: 2.5rem; color: var(--primary);"></i>
                    <h2 class="mb-0 mt-2" style="font-weight: 600;">{{ total_socios }}</h2>
                    <small class="text-muted">Socios Activos</small>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card text-center h-100" style="border: 1px solid var(--border); background: var(--bg-white); transition: all 0.2s;">
                <div class="card-body p-3">
                    <i class="bi bi-arrow-repeat" style="font-size: 2.5rem; color: #F0AD4E;"></i>
                    <h2 class="mb-0 mt-2" style="font-weight: 600;">{{ prestamos_activos }}</h2>
                    <small class="text-muted">Préstamos Activos</small>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card text-center h-100 card-multas-stat {% if multas_pendientes > 0 %}border-danger{% endif %}">
                <div class="card-body p-3">
                    <i class="bi bi-cash-coin icon-multas-stat {% if multas_pendientes > 0 %}text-danger{% else %}text-muted{% endif %}"></i>
                    <h2 class="mb-0 mt-2" style="font-weight: 600;">{{ multas_pendientes }}</h2>
                    <small class="text-muted">Multas{% if multas_pendientes > 0 %} <span class="text-danger fw-bold">${{ monto_multas_pendientes }}</span>{% endif %}</small>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Navegación principal -->
<div class="container">
    <h4 class="mb-4" style="font-family: 'Crimson Text', serif; color: var(--text-dark);">
        <i class="bi bi-grid-3x3-gap me-2"></i>Gestión
    </h4>
    <div class="row g-4 mb-5">
        <div class="col-md-3 col-6">
            <a href="{% url 'listar_libros' %}" class="card text-decoration-none h-100 nav-card" style="border: 2px solid var(--border);">
                <div class="card-body text-center p-4">
                    <i class="bi bi-book-half" style="font-size: 3rem; color: var(--primary);"></i>
                    <h5 class="mt-3 mb-1" style="color: var(--text-dark);">Catálogo</h5>
                    <small class="text-muted">Gestionar libros</small>
                </div>
            </a>
        </div>
        <div class="col-md-3 col-6">
            <a href="{% url 'listar_socios' %}" class="card text-decoration-none h-100 nav-card" style="border: 2px solid var(--border);">
                <div class="card-body text-center p-4">
                    <i class="bi bi-people" style="font-size: 3rem; color: var(--primary);"></i>
                    <h5 class="mt-3 mb-1" style="color: var(--text-dark);">Socios</h5>
                    <small class="text-muted">Administrar socios</small>
                </div>
            </a>
        </div>
        <div class="col-md-3 col-6">
            <a href="{% url 'listar_prestamos' %}" class="card text-decoration-none h-100 nav-card" style="border: 2px solid var(--border);">
                <div class="card-body text-center p-4">
                    <i class="bi bi-arrow-left-right" style="font-size: 3rem; color: var(--primary);"></i>
                    <h5 class="mt-3 mb-1" style="color: var(--text-dark);">Préstamos</h5>
                    <small class="text-muted">Gestionar préstamos</small>
                </div>
            </a>
        </div>
        <div class="col-md-3 col-6">
            <a href="{% url 'listar_multas' %}" class="card text-decoration-none h-100 nav-card" style="border: 2px solid var(--border);">
                <div class="card-body text-center p-4">
                    <i class="bi bi-cash-coin" style="font-size: 3rem; color: var(--primary);"></i>
                    <h5 class="mt-3 mb-1" style="color: var(--text-dark);">Multas</h5>
                    <small class="text-muted">Gestionar multas</small>
                </div>
            </a>
        </div>
    </div>
</div>

<style>
    .nav-card {
        transition: all 0.3s ease;
        background: var(--bg-white);
    }
    .nav-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        border-color: var(--primary) !important;
    }
    .card-multas-stat {
        border: 1px solid var(--border);
        background: var(--bg-white);
        transition: all 0.2s;
    }
    .icon-multas-stat {
        font-size: 2.5rem;
    }
</style>
{% endblock %}